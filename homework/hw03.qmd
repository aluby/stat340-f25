---
title: "Individual HW03"
author: "Your Name Here"
---

```{r}
library(bayesrules) # R package for our textbook
library(tidyverse) # Collection of packages for tidying and plotting data
library(janitor) # Helper functions like tidy and tabyl
```

# BR Exercise 5.1 a, d, f

For each situation below, tune an appropriate Gamma(s, r) prior model for $\lambda$

(a) The most common value of $\lambda$ is 4, and the mean is 7.
(d) The most common value of $\lambda$ is 14, and the variance is 6.
(f) The mean of $\lambda$ is 22, and the variance is 3.

# BR Exercise 5.7 

Let $\lambda$ be the average number of goals scored in a Women's World Cup game. We'll analyze $\lambda$ by the following Gamma-Poisson model: 
$$Y_i | \lambda \sim \text{Poisson}(\lambda)$$
$$\lambda \sim \text{Gamma}(1, 0.25)$$

(a) Plot and summarize our prior understanding of $\lambda$
(b) Why is the Poisson model a reasonable choice for $Y_i$?
(c) The `wwc_2019_matches` data in the {fivethirtyeight} package includes the number of goals scored by the two teams in each 2019 Women's World Cup match. Define, plot, and discuss the total number of goals scored per game

```{r}
library(fivethirtyeight)
data("wwc_2019_matches")
wwc_2019_matches <- wwc_2019_matches %>% 
  mutate(total_goals = score1 + score2)
```

(d) identify the posterior model of $\lambda$ and verify your answer using `summarize_gamma_poisson()`
(e) Plot the prior, likelihood, and posterior of $\lambda$. Describe the evolution in your understanding of $\lambda$ from the prior to posterior. 

# BR Exercise 5.15

Below are kernels for Normal, Poisson, Gamma, Beta, and Binomial models. Identify the appropriate model with specific parameter values.

(a) $f(\theta) \propto 0.3^\theta 0.7^{16 - \theta}$ for $\theta \in \{0, 1, 2 ..., 16\}$
(b) $f(\theta) \propto 1/\theta!$ for $\theta \in \{0, 1, ..., \infty\}$
(c) $f(\theta) \propto \theta^4(1-\theta)^7$ for $\theta \in [0,1]$
(d) $f(\theta) \propto e^{-\theta^2}$

# Normal-normal conjugacy

Verify that the normal distribution is a conjugate prior for a normal data model. 

*Note:* the sketch of this proof is given in 5.3.4 and you are welcome to use it. If you use other sources (e.g. for help remembering how to complete the square), please cite them. 

# BR Exercise 5.11 (Normal-normal calculation) 

Prof. Abebe and Prof. Morales both recently finished their PhDs and are teaching their first statistics classes at Bayesian University. Their colleagues told them that the average final exam score across all students, $\mu$, varies Normally from year to year with a mean of 80 points and a standard deviation of 4. Further, individual students’ scores $Y$ vary Normally around $\mu$ with a known standard deviation of 3 points.

(a) Prof. Abebe conducts the final exam and observes that his 32 students scored an average of 86 points. Calculate the posterior mean and variance of $\mu$ using the data from Prof. Abebe’s class.
(b) Prof. Morales conducts the final exam and observes that her 32 students scored an average of 82 points. Calculate the posterior mean and variance of $\mu$ using the data from Prof. Morales’ class.
(c) Next, use Prof. Abebe and Prof. Morales’ _combined_ exams to calculate the posterior mean and variance of $\mu$

# BR Exercise 5.14: Normal-normal simulation

(a) Your friend Alex has read Chapter 4 of this book, but not Chapter 5. Explain to Alex why it’s difficult to simulate a Normal-Normal posterior using the simulation methods we have learned thus far.
(b) To prove your point, try (and fail) to simulate the posterior of $\mu$ for the following model upon observing a single data point  $Y_1 = 1.1$: 

$$Y | \mu \sim N(\mu, 1^2)$$ 
$$\mu \sim N(0,1)$$

# BR Exercise 6.6: Gamma-Poisson grid approximation

Consider the Gamma-Poisson model for $\lambda$ with $\lambda \sim \text{Gamma}(20, 5)$ and $Y_i | \lambda \sim \text{Pois}(\lambda)$. Suppose you observe $n=3$ data points $(Y_1, Y_2, Y_3) = (0, 1, 0)$

(a) Utilize grid approximation with grid values $\lambda = \{0, 1, 2, ..., 8\}$ to approximate the posterior of $\lambda$
(b) Repeat part a using a grid of 201 equally spaced values between 0 and 8.


# BR Exercise 6.15: Gamma-Poisson MCMC (skip traceplots for now)

(a) Simulate the posterior model of $\lambda$ with RStan using 4 chains and 10000 iterations per chain.
(b) Produce ~~trace and~~ density plots for all four chains.
(c) From the density plots, what seems to be the most posterior plausible value of $\lambda$?
(d) Hearkening back to Chapter 5, specify the theoretical posterior model of $\lambda$. How does your MCMC approximation compare? (Try adding an overlaying line to your density plot from (c))

# BR Exercise 6.9: Comparing MCMC to grid approximation

(a) What drawback(s) do MCMC and grid approximation share?
(b) What advantage(s) do MCMC and grid approximation share?
(c) What is an advantage of grid approximation over MCMC?
(d) What is an advantage of MCMC over grid approximation?


