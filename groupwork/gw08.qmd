---
title: "Group Work 07"
---

```{r}
library(bayesrules) # R package for our textbook
library(tidyverse) # Collection of packages for tidying and plotting data
library(janitor) # Helper functions like tabyl
library(rstan) # for fitting models
library(rstanarm) # for fitting standard regression models
library(broom.mixed) # for tidy() function
library(bayesplot) # helpful plotting functions
library(tidybayes) # helpful for wrangling Bayesian model output
library(patchwork)
```

# BR 13.2

Calculate and interpret the odds for each event of interest below.

(a) The probability of rain tomorrow is 0.8.
(b) The probability of flipping 2 Heads in a row is 0.25.
(c) The log(odds) that your bus will be on time are 0.
(d) The log(odds) that a person is left-handed are -1.386.

# Fri 

```{r}
p1 <- pulse_of_the_nation %>%
  ggplot(aes(x = age, y = ghosts)) +
  geom_violin()


p2 <- pulse_of_the_nation %>%
  ggplot(aes(y = education, fill = ghosts)) +
  geom_bar(position = "fill")

p3 <- pulse_of_the_nation %>%
  ggplot(aes(x = books, y = ghosts)) +
  geom_violin()

# Combine plots
p1 + p2 + p3
```

```{r}
ghost_posterior <- stan_glm(
  ghosts ~ age + education + books,
  data = pulse_of_the_nation,
  family = binomial(link = "logit"),
  chains = 4, iter = 2000, refresh = 0
)

tidy(ghost_posterior, conf.int = TRUE)

mcmc_trace(ghost_posterior)
mcmc_dens_overlay(ghost_posterior)
mcmc_acf(ghost_posterior)

proportion <- function(x){mean(x == 1)}
pp_check(ghost_posterior, nreps = 100,
         plotfun = "stat", stat = "proportion") 

pp_check(ghost_posterior, plotfun = "error_scatter_avg_vs_x") 
```


# Mon

# Mon

# Wed

# Wed

